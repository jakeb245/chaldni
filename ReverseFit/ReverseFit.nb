(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     15723,        350]
NotebookOptionsPosition[     13574,        308]
NotebookOutlinePosition[     14009,        325]
CellTagsIndexPosition[     13966,        322]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"freq", "=", "4365"}], "\[IndentingNewLine]", 
 RowBox[{"a", "=", "0.24"}], "\[IndentingNewLine]", 
 RowBox[{"Y", "=", "200*^9"}], "\[IndentingNewLine]", 
 RowBox[{"d", "=", "0.001"}], "\[IndentingNewLine]", 
 RowBox[{"\[Nu]", "=", "0.303"}], "\[IndentingNewLine]", 
 RowBox[{"\[Rho]", "=", "7850"}], "\[IndentingNewLine]", 
 RowBox[{"cTheo", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "/", 
     RowBox[{"(", 
      RowBox[{"2", "*", "Pi"}], ")"}]}], ")"}], "*", 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Y", "*", 
       RowBox[{"d", "^", "2"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"12", "*", "\[Rho]", "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"\[Nu]", "^", "2"}]}], ")"}]}], ")"}]}], "]"}]}]}]}], "Input",\

 CellChangeTimes->{{3.8855602558187027`*^9, 3.88556031818255*^9}, {
  3.885560476649725*^9, 3.8855605595479927`*^9}, {3.885820230239852*^9, 
  3.885820233048696*^9}, {3.885847346212088*^9, 3.885847346568233*^9}, {
  3.885893224771881*^9, 3.885893227287763*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"49b35399-ad41-4c64-a40c-eeaff7337e2a"],

Cell[BoxData["4365"], "Output",
 CellChangeTimes->{
  3.885560560144606*^9, 3.885818459896516*^9, 3.885819001249103*^9, {
   3.885819143278079*^9, 3.885819156699789*^9}, 3.885819916295597*^9, 
   3.885820238653555*^9, 3.885820346756187*^9, 3.885847360625305*^9, 
   3.8858837840104856`*^9, 3.885883964106028*^9, 3.885884643581234*^9, 
   3.885884732597497*^9, 3.88588509172675*^9, 3.8858932370771112`*^9},
 CellLabel->"Out[1]=",ExpressionUUID->"49998644-c1a5-4e2e-9a06-1f9c0cf621ca"],

Cell[BoxData["0.24`"], "Output",
 CellChangeTimes->{
  3.885560560144606*^9, 3.885818459896516*^9, 3.885819001249103*^9, {
   3.885819143278079*^9, 3.885819156699789*^9}, 3.885819916295597*^9, 
   3.885820238653555*^9, 3.885820346756187*^9, 3.885847360625305*^9, 
   3.8858837840104856`*^9, 3.885883964106028*^9, 3.885884643581234*^9, 
   3.885884732597497*^9, 3.88588509172675*^9, 3.885893237078986*^9},
 CellLabel->"Out[2]=",ExpressionUUID->"2335023b-cea8-4c99-85d2-4fa463a350c5"],

Cell[BoxData["200000000000"], "Output",
 CellChangeTimes->{
  3.885560560144606*^9, 3.885818459896516*^9, 3.885819001249103*^9, {
   3.885819143278079*^9, 3.885819156699789*^9}, 3.885819916295597*^9, 
   3.885820238653555*^9, 3.885820346756187*^9, 3.885847360625305*^9, 
   3.8858837840104856`*^9, 3.885883964106028*^9, 3.885884643581234*^9, 
   3.885884732597497*^9, 3.88588509172675*^9, 3.885893237080236*^9},
 CellLabel->"Out[3]=",ExpressionUUID->"918b85bf-b4d2-4c7f-abfb-bf16e6e6572c"],

Cell[BoxData["0.001`"], "Output",
 CellChangeTimes->{
  3.885560560144606*^9, 3.885818459896516*^9, 3.885819001249103*^9, {
   3.885819143278079*^9, 3.885819156699789*^9}, 3.885819916295597*^9, 
   3.885820238653555*^9, 3.885820346756187*^9, 3.885847360625305*^9, 
   3.8858837840104856`*^9, 3.885883964106028*^9, 3.885884643581234*^9, 
   3.885884732597497*^9, 3.88588509172675*^9, 3.885893237081457*^9},
 CellLabel->"Out[4]=",ExpressionUUID->"d9fa9222-6357-4290-87f7-3a31c3f2291a"],

Cell[BoxData["0.303`"], "Output",
 CellChangeTimes->{
  3.885560560144606*^9, 3.885818459896516*^9, 3.885819001249103*^9, {
   3.885819143278079*^9, 3.885819156699789*^9}, 3.885819916295597*^9, 
   3.885820238653555*^9, 3.885820346756187*^9, 3.885847360625305*^9, 
   3.8858837840104856`*^9, 3.885883964106028*^9, 3.885884643581234*^9, 
   3.885884732597497*^9, 3.88588509172675*^9, 3.8858932370826674`*^9},
 CellLabel->"Out[5]=",ExpressionUUID->"cd929f5b-acfa-4c2d-be6e-31436242c388"],

Cell[BoxData["7850"], "Output",
 CellChangeTimes->{
  3.885560560144606*^9, 3.885818459896516*^9, 3.885819001249103*^9, {
   3.885819143278079*^9, 3.885819156699789*^9}, 3.885819916295597*^9, 
   3.885820238653555*^9, 3.885820346756187*^9, 3.885847360625305*^9, 
   3.8858837840104856`*^9, 3.885883964106028*^9, 3.885884643581234*^9, 
   3.885884732597497*^9, 3.88588509172675*^9, 3.885893237083973*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"333eb880-3cf1-435d-962f-d09266bbb5e0"],

Cell[BoxData["0.24334424576906918`"], "Output",
 CellChangeTimes->{
  3.885560560144606*^9, 3.885818459896516*^9, 3.885819001249103*^9, {
   3.885819143278079*^9, 3.885819156699789*^9}, 3.885819916295597*^9, 
   3.885820238653555*^9, 3.885820346756187*^9, 3.885847360625305*^9, 
   3.8858837840104856`*^9, 3.885883964106028*^9, 3.885884643581234*^9, 
   3.885884732597497*^9, 3.88588509172675*^9, 3.885893237085297*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"339bce3a-18b9-4c5c-95e6-3eeb20545a27"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"cLow", "=", 
  RowBox[{"cTheo", "-", 
   RowBox[{"(", 
    RowBox[{"0.25", "*", "cTheo"}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"cHigh", "=", 
  RowBox[{"cTheo", "+", 
   RowBox[{"(", 
    RowBox[{"0.25", "*", "cTheo"}], ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.885560566443014*^9, 3.885560609333599*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"9b5b74e6-5b5f-44bd-85b5-b3b3527c831c"],

Cell[BoxData["0.18250818432680188`"], "Output",
 CellChangeTimes->{
  3.885560609772871*^9, 3.88581846004809*^9, 3.885819001345427*^9, {
   3.885819143361342*^9, 3.885819156826386*^9}, 3.885819916410344*^9, 
   3.885820238729496*^9, 3.88582034684626*^9, 3.885847360697672*^9, 
   3.885883784100843*^9, 3.885883964163012*^9, 3.885884735701221*^9, 
   3.8858850918111877`*^9, 3.8858932371318073`*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"0b22964e-e89c-4117-810f-b938b4b682f3"],

Cell[BoxData["0.3041803072113365`"], "Output",
 CellChangeTimes->{
  3.885560609772871*^9, 3.88581846004809*^9, 3.885819001345427*^9, {
   3.885819143361342*^9, 3.885819156826386*^9}, 3.885819916410344*^9, 
   3.885820238729496*^9, 3.88582034684626*^9, 3.885847360697672*^9, 
   3.885883784100843*^9, 3.885883964163012*^9, 3.885884735701221*^9, 
   3.8858850918111877`*^9, 3.8858932371335278`*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"68c05cd8-24ac-459c-ab84-573e2df572fa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"nRuns", "=", "16"}]], "Input",
 CellChangeTimes->{{3.885560616675118*^9, 3.885560633843235*^9}, {
  3.885818448271838*^9, 3.885818453737425*^9}, {3.885820144715013*^9, 
  3.885820152478344*^9}, {3.885820305744879*^9, 3.885820339367899*^9}, {
  3.885847335971506*^9, 3.885847338778906*^9}, {3.885885072549444*^9, 
  3.885885077690027*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"0fd7c429-659b-4d29-b125-3c79784dd6d2"],

Cell[BoxData["16"], "Output",
 CellChangeTimes->{
  3.885560636210833*^9, 3.885818460071982*^9, 3.885819001360907*^9, {
   3.885819143377328*^9, 3.8858191568629704`*^9}, 3.885819916431622*^9, 
   3.885820238753087*^9, 3.885820313690943*^9, 3.885820346864002*^9, 
   3.885847360711191*^9, 3.885883784106925*^9, 3.885883964186854*^9, 
   3.885884737702373*^9, 3.8858850918266582`*^9, 3.8858932371381817`*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"c1eee01b-4db8-41a6-991a-d7c2474ccdc7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"nTerms", "=", "60"}]], "Input",
 CellChangeTimes->{{3.885560636777214*^9, 3.885560641127577*^9}, {
  3.8858189848342752`*^9, 3.8858189867740793`*^9}, {3.88581990945512*^9, 
  3.885819910355236*^9}, {3.885820154102707*^9, 3.8858201553731422`*^9}, {
  3.88582031582272*^9, 3.885820320595546*^9}, {3.885847340208262*^9, 
  3.885847341597299*^9}, {3.885885068460964*^9, 3.88588508004662*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"6e404117-c5ab-4872-a55d-42b432744c3c"],

Cell[BoxData["60"], "Output",
 CellChangeTimes->{
  3.885560642693235*^9, 3.8858184600821238`*^9, 3.885819001385641*^9, {
   3.885819143400238*^9, 3.885819156875066*^9}, 3.88581991645923*^9, 
   3.88582023876437*^9, 3.885820346890432*^9, 3.885847360725397*^9, 
   3.885883784111601*^9, 3.8858839642028*^9, 3.885884739303632*^9, 
   3.8858850918493757`*^9, 3.885893237152828*^9},
 CellLabel->"Out[11]=",ExpressionUUID->"2f284c2f-a881-47a1-b277-3a50dc20a96a"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"kn", "[", 
   RowBox[{"n1_", ",", "n2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"Pi", "/", "a"}], ")"}], "*", 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{"n1", "^", "2"}], "+", 
     RowBox[{"n2", "^", "2"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mode", "[", 
   RowBox[{"x_", ",", "y_", ",", "n1_", ",", "n2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"2", "/", "a"}], ")"}], "*", 
   RowBox[{"Cos", "[", 
    RowBox[{"n1", "*", "Pi", "*", 
     RowBox[{"x", "/", "a"}]}], "]"}], "*", 
   RowBox[{"Cos", "[", 
    RowBox[{"n2", "*", "Pi", "*", 
     RowBox[{"y", "/", "a"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "[", 
   RowBox[{"x_", ",", "y_", ",", "freq_", ",", "c_"}], "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"mode", "[", 
      RowBox[{
       RowBox[{"a", "/", "2"}], ",", 
       RowBox[{"a", "/", "2"}], ",", "n1", ",", "n2"}], "]"}], "*", 
     RowBox[{
      RowBox[{"mode", "[", 
       RowBox[{"x", ",", "y", ",", "n1", ",", "n2"}], "]"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"kn", "[", 
          RowBox[{"n1", ",", "n2"}], "]"}], "^", "2"}], "-", 
        RowBox[{"(", 
         RowBox[{"freq", "/", "c"}], ")"}]}], ")"}]}]}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"n1", ",", "0", ",", "nTerms"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"n2", ",", "0", ",", "nTerms"}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8855606730936193`*^9, 3.885560675119235*^9}, {
   3.885818482917547*^9, 3.8858185172566347`*^9}, {3.885818797598052*^9, 
   3.885818813535034*^9}, 3.885818965274646*^9, {3.885819575222086*^9, 
   3.8858195768394623`*^9}, {3.8858846920349617`*^9, 3.885884704587618*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"24312c1b-400a-4fbb-9468-a8fc4dae3579"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ParallelDo", "[", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"\"\</Users/jakebuchanan/code/chladni/ReverseFit/Freq\>\"", "<>", 
      RowBox[{"ToString", "[", "freq", "]"}], "<>", "\"\<C\>\"", "<>", 
      RowBox[{"StringPadLeft", "[", 
       RowBox[{
        RowBox[{"ToString", "[", "c", "]"}], ",", "6"}], "]"}], "<>", 
      "\"\<.PNG\>\""}], ",", 
     RowBox[{"ContourPlot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"x", ",", "y", ",", "freq", ",", "c"}], "]"}], "==", "0"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", "a"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", "0", ",", "a"}], "}"}], ",", 
       RowBox[{"ContourStyle", "->", "White"}], ",", 
       RowBox[{"Background", "->", "Black"}], ",", 
       RowBox[{"PlotTheme", "->", "\"\<Minimal\>\""}]}], "]"}], ",", " ", 
     "\"\<PNG\>\""}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", "cLow", ",", "cHigh", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"cHigh", "-", "cLow"}], ")"}], "/", "nRuns"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.885818526549354*^9, 3.885818566265308*^9}, {
   3.8858186809271193`*^9, 3.8858187810116997`*^9}, {3.8858188497676687`*^9, 
   3.885818882083952*^9}, {3.885818931079131*^9, 3.885818943854774*^9}, {
   3.885819130750436*^9, 3.885819152922278*^9}, {3.885819395041683*^9, 
   3.8858193978766413`*^9}, {3.8858195259876957`*^9, 3.885819535557282*^9}, {
   3.885819587529626*^9, 3.885819636847371*^9}, {3.885819810446362*^9, 
   3.885819892309881*^9}, {3.885847061286047*^9, 3.885847255021385*^9}, {
   3.885847295885491*^9, 3.885847325688655*^9}, {3.88584739168232*^9, 
   3.885847392291507*^9}, {3.885847428132947*^9, 3.885847474961486*^9}, {
   3.885847566267685*^9, 3.885847593967288*^9}, {3.8858476487581*^9, 
   3.8858476587496157`*^9}, {3.885847691372657*^9, 3.885847722943563*^9}, {
   3.885847765423195*^9, 3.885847798212092*^9}, {3.885847837277926*^9, 
   3.8858478709253807`*^9}, {3.8858479857852297`*^9, 3.885847997512973*^9}, {
   3.885848114431168*^9, 3.8858481234010344`*^9}, {3.885848184517954*^9, 
   3.885848187697804*^9}, {3.885848227640504*^9, 3.885848288249576*^9}, {
   3.885848431086994*^9, 3.8858484856156*^9}, 3.885848516356082*^9, {
   3.8858486030899687`*^9, 3.885848664218157*^9}, {3.885848694828702*^9, 
   3.885848771384098*^9}, {3.885848841566947*^9, 3.885848877102891*^9}, {
   3.8858489409592867`*^9, 3.885849000209694*^9}, {3.885883908290557*^9, 
   3.885883912381751*^9}, {3.8858842453422413`*^9, 3.8858842509515057`*^9}, {
   3.885884376007428*^9, 3.885884393987273*^9}, {3.885884512438032*^9, 
   3.885884512567499*^9}, {3.885884720854966*^9, 3.885884721038155*^9}, {
   3.8858850303886127`*^9, 3.885885066097192*^9}, {3.885885173720779*^9, 
   3.8858851744972267`*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"2cca079a-6d89-400b-b5f4-7d4b81778c45"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.885893379155546*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"a6f6fb3c-7432-4030-93a3-b0c7d812f074"]
}, Open  ]]
},
WindowSize->{808, 706},
WindowMargins->{{20, Automatic}, {Automatic, 44}},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"13.1 for Mac OS X ARM (64-bit) (June 16, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"546a68e2-b863-4ab3-92a3-c2cc9d71566d"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1155, 28, 157, "Input",ExpressionUUID->"49b35399-ad41-4c64-a40c-eeaff7337e2a"],
Cell[1738, 52, 483, 7, 34, "Output",ExpressionUUID->"49998644-c1a5-4e2e-9a06-1f9c0cf621ca"],
Cell[2224, 61, 482, 7, 34, "Output",ExpressionUUID->"2335023b-cea8-4c99-85d2-4fa463a350c5"],
Cell[2709, 70, 489, 7, 34, "Output",ExpressionUUID->"918b85bf-b4d2-4c7f-abfb-bf16e6e6572c"],
Cell[3201, 79, 483, 7, 34, "Output",ExpressionUUID->"d9fa9222-6357-4290-87f7-3a31c3f2291a"],
Cell[3687, 88, 485, 7, 34, "Output",ExpressionUUID->"cd929f5b-acfa-4c2d-be6e-31436242c388"],
Cell[4175, 97, 481, 7, 34, "Output",ExpressionUUID->"333eb880-3cf1-435d-962f-d09266bbb5e0"],
Cell[4659, 106, 497, 7, 34, "Output",ExpressionUUID->"339bce3a-18b9-4c5c-95e6-3eeb20545a27"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5193, 118, 418, 10, 52, "Input",ExpressionUUID->"9b5b74e6-5b5f-44bd-85b5-b3b3527c831c"],
Cell[5614, 130, 476, 7, 34, "Output",ExpressionUUID->"0b22964e-e89c-4117-810f-b938b4b682f3"],
Cell[6093, 139, 475, 7, 34, "Output",ExpressionUUID->"68c05cd8-24ac-459c-ab84-573e2df572fa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6605, 151, 441, 7, 30, "Input",ExpressionUUID->"0fd7c429-659b-4d29-b125-3c79784dd6d2"],
Cell[7049, 160, 485, 7, 34, "Output",ExpressionUUID->"c1eee01b-4db8-41a6-991a-d7c2474ccdc7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7571, 172, 491, 7, 30, "Input",ExpressionUUID->"6e404117-c5ab-4872-a55d-42b432744c3c"],
Cell[8065, 181, 457, 7, 34, "Output",ExpressionUUID->"2f284c2f-a881-47a1-b277-3a50dc20a96a"]
}, Open  ]],
Cell[8537, 191, 1889, 51, 115, "Input",ExpressionUUID->"24312c1b-400a-4fbb-9468-a8fc4dae3579"],
Cell[CellGroupData[{
Cell[10451, 246, 2948, 55, 136, "Input",ExpressionUUID->"2cca079a-6d89-400b-b5f4-7d4b81778c45"],
Cell[13402, 303, 156, 2, 57, "Output",ExpressionUUID->"a6f6fb3c-7432-4030-93a3-b0c7d812f074"]
}, Open  ]]
}
]
*)


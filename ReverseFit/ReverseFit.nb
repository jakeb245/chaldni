(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     16762,        370]
NotebookOptionsPosition[     14738,        331]
NotebookOutlinePosition[     15173,        348]
CellTagsIndexPosition[     15130,        345]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"freq", "=", "965"}], "\[IndentingNewLine]", 
 RowBox[{"a", "=", "0.24"}], "\[IndentingNewLine]", 
 RowBox[{"Y", "=", "200*^9"}], "\[IndentingNewLine]", 
 RowBox[{"d", "=", "0.001"}], "\[IndentingNewLine]", 
 RowBox[{"\[Nu]", "=", "0.303"}], "\[IndentingNewLine]", 
 RowBox[{"\[Rho]", "=", "7850"}], "\[IndentingNewLine]", 
 RowBox[{"cTheo", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "/", 
     RowBox[{"(", 
      RowBox[{"2", "*", "Pi"}], ")"}]}], ")"}], "*", 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Y", "*", 
       RowBox[{"d", "^", "2"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"12", "*", "\[Rho]", "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"\[Nu]", "^", "2"}]}], ")"}]}], ")"}]}], "]"}]}]}]}], "Input",\

 CellChangeTimes->{{3.8855602558187027`*^9, 3.88556031818255*^9}, {
  3.885560476649725*^9, 3.8855605595479927`*^9}, {3.885820230239852*^9, 
  3.885820233048696*^9}, {3.885847346212088*^9, 3.885847346568233*^9}, {
  3.885893224771881*^9, 3.885893227287763*^9}, {3.885919392341053*^9, 
  3.885919395485106*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"49b35399-ad41-4c64-a40c-eeaff7337e2a"],

Cell[BoxData["965"], "Output",
 CellChangeTimes->{
  3.885560560144606*^9, 3.885818459896516*^9, 3.885819001249103*^9, {
   3.885819143278079*^9, 3.885819156699789*^9}, 3.885819916295597*^9, 
   3.885820238653555*^9, 3.885820346756187*^9, 3.885847360625305*^9, 
   3.8858837840104856`*^9, 3.885883964106028*^9, 3.885884643581234*^9, 
   3.885884732597497*^9, 3.88588509172675*^9, 3.8858932370771112`*^9, 
   3.88597205957187*^9, 3.885994275284855*^9},
 CellLabel->"Out[89]=",ExpressionUUID->"d9255cd3-4750-4d74-9dbb-394575e418c2"],

Cell[BoxData["0.24`"], "Output",
 CellChangeTimes->{
  3.885560560144606*^9, 3.885818459896516*^9, 3.885819001249103*^9, {
   3.885819143278079*^9, 3.885819156699789*^9}, 3.885819916295597*^9, 
   3.885820238653555*^9, 3.885820346756187*^9, 3.885847360625305*^9, 
   3.8858837840104856`*^9, 3.885883964106028*^9, 3.885884643581234*^9, 
   3.885884732597497*^9, 3.88588509172675*^9, 3.8858932370771112`*^9, 
   3.88597205957187*^9, 3.885994275287964*^9},
 CellLabel->"Out[90]=",ExpressionUUID->"183ca76a-5d91-4d27-99d9-4b12384294aa"],

Cell[BoxData["200000000000"], "Output",
 CellChangeTimes->{
  3.885560560144606*^9, 3.885818459896516*^9, 3.885819001249103*^9, {
   3.885819143278079*^9, 3.885819156699789*^9}, 3.885819916295597*^9, 
   3.885820238653555*^9, 3.885820346756187*^9, 3.885847360625305*^9, 
   3.8858837840104856`*^9, 3.885883964106028*^9, 3.885884643581234*^9, 
   3.885884732597497*^9, 3.88588509172675*^9, 3.8858932370771112`*^9, 
   3.88597205957187*^9, 3.885994275289546*^9},
 CellLabel->"Out[91]=",ExpressionUUID->"2f973046-53d3-4a75-a05a-e031bd9524e6"],

Cell[BoxData["0.001`"], "Output",
 CellChangeTimes->{
  3.885560560144606*^9, 3.885818459896516*^9, 3.885819001249103*^9, {
   3.885819143278079*^9, 3.885819156699789*^9}, 3.885819916295597*^9, 
   3.885820238653555*^9, 3.885820346756187*^9, 3.885847360625305*^9, 
   3.8858837840104856`*^9, 3.885883964106028*^9, 3.885884643581234*^9, 
   3.885884732597497*^9, 3.88588509172675*^9, 3.8858932370771112`*^9, 
   3.88597205957187*^9, 3.885994275291052*^9},
 CellLabel->"Out[92]=",ExpressionUUID->"fc027934-a8ad-40eb-86e2-b8bed398aaa2"],

Cell[BoxData["0.303`"], "Output",
 CellChangeTimes->{
  3.885560560144606*^9, 3.885818459896516*^9, 3.885819001249103*^9, {
   3.885819143278079*^9, 3.885819156699789*^9}, 3.885819916295597*^9, 
   3.885820238653555*^9, 3.885820346756187*^9, 3.885847360625305*^9, 
   3.8858837840104856`*^9, 3.885883964106028*^9, 3.885884643581234*^9, 
   3.885884732597497*^9, 3.88588509172675*^9, 3.8858932370771112`*^9, 
   3.88597205957187*^9, 3.88599427529263*^9},
 CellLabel->"Out[93]=",ExpressionUUID->"56053f14-85f4-4237-9d1a-60b0a251640b"],

Cell[BoxData["7850"], "Output",
 CellChangeTimes->{
  3.885560560144606*^9, 3.885818459896516*^9, 3.885819001249103*^9, {
   3.885819143278079*^9, 3.885819156699789*^9}, 3.885819916295597*^9, 
   3.885820238653555*^9, 3.885820346756187*^9, 3.885847360625305*^9, 
   3.8858837840104856`*^9, 3.885883964106028*^9, 3.885884643581234*^9, 
   3.885884732597497*^9, 3.88588509172675*^9, 3.8858932370771112`*^9, 
   3.88597205957187*^9, 3.8859942752942133`*^9},
 CellLabel->"Out[94]=",ExpressionUUID->"ec9a0713-0f14-423c-af29-61cd7c7db50f"],

Cell[BoxData["0.24334424576906918`"], "Output",
 CellChangeTimes->{
  3.885560560144606*^9, 3.885818459896516*^9, 3.885819001249103*^9, {
   3.885819143278079*^9, 3.885819156699789*^9}, 3.885819916295597*^9, 
   3.885820238653555*^9, 3.885820346756187*^9, 3.885847360625305*^9, 
   3.8858837840104856`*^9, 3.885883964106028*^9, 3.885884643581234*^9, 
   3.885884732597497*^9, 3.88588509172675*^9, 3.8858932370771112`*^9, 
   3.88597205957187*^9, 3.885994275295808*^9},
 CellLabel->"Out[95]=",ExpressionUUID->"9a54044c-3410-4d6b-8b3e-db61cbacce5e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"cLow", "=", 
  RowBox[{"cTheo", "-", 
   RowBox[{"(", 
    RowBox[{"0.25", "*", "cTheo"}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"cHigh", "=", 
  RowBox[{"cTheo", "+", 
   RowBox[{"(", 
    RowBox[{"0.25", "*", "cTheo"}], ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.885560566443014*^9, 3.885560609333599*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"9b5b74e6-5b5f-44bd-85b5-b3b3527c831c"],

Cell[BoxData["0.18250818432680188`"], "Output",
 CellChangeTimes->{
  3.885560609772871*^9, 3.88581846004809*^9, 3.885819001345427*^9, {
   3.885819143361342*^9, 3.885819156826386*^9}, 3.885819916410344*^9, 
   3.885820238729496*^9, 3.88582034684626*^9, 3.885847360697672*^9, 
   3.885883784100843*^9, 3.885883964163012*^9, 3.885884735701221*^9, 
   3.8858850918111877`*^9, 3.8858932371318073`*^9, 3.885972059620129*^9, 
   3.885994275337985*^9},
 CellLabel->"Out[96]=",ExpressionUUID->"ba1c6796-1b87-4075-b1ed-c73a3cc2f9d6"],

Cell[BoxData["0.3041803072113365`"], "Output",
 CellChangeTimes->{
  3.885560609772871*^9, 3.88581846004809*^9, 3.885819001345427*^9, {
   3.885819143361342*^9, 3.885819156826386*^9}, 3.885819916410344*^9, 
   3.885820238729496*^9, 3.88582034684626*^9, 3.885847360697672*^9, 
   3.885883784100843*^9, 3.885883964163012*^9, 3.885884735701221*^9, 
   3.8858850918111877`*^9, 3.8858932371318073`*^9, 3.885972059620129*^9, 
   3.8859942753403893`*^9},
 CellLabel->"Out[97]=",ExpressionUUID->"adfcffb6-26bf-4c50-a020-3b5596937841"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"nRuns", "=", "24"}]], "Input",
 CellChangeTimes->{{3.885560616675118*^9, 3.885560633843235*^9}, {
  3.885818448271838*^9, 3.885818453737425*^9}, {3.885820144715013*^9, 
  3.885820152478344*^9}, {3.885820305744879*^9, 3.885820339367899*^9}, {
  3.885847335971506*^9, 3.885847338778906*^9}, {3.885885072549444*^9, 
  3.885885077690027*^9}, {3.885919378414627*^9, 3.885919380816943*^9}, {
  3.885972041458403*^9, 3.8859720423753223`*^9}, {3.885994214358917*^9, 
  3.8859942170962753`*^9}, {3.885994699542468*^9, 3.885994700386374*^9}, {
  3.88615838315783*^9, 
  3.886158399178615*^9}},ExpressionUUID->"0fd7c429-659b-4d29-b125-\
3c79784dd6d2"],

Cell[BoxData["4"], "Output",
 CellChangeTimes->{
  3.885560636210833*^9, 3.885818460071982*^9, 3.885819001360907*^9, {
   3.885819143377328*^9, 3.8858191568629704`*^9}, 3.885819916431622*^9, 
   3.885820238753087*^9, 3.885820313690943*^9, 3.885820346864002*^9, 
   3.885847360711191*^9, 3.885883784106925*^9, 3.885883964186854*^9, 
   3.885884737702373*^9, 3.8858850918266582`*^9, 3.8858932371381817`*^9, 
   3.8859720596279917`*^9, 3.885994275346839*^9},
 CellLabel->"Out[98]=",ExpressionUUID->"aa338c91-0e96-4001-aaa5-e8cb2502485c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"nTerms", "=", "75"}]], "Input",
 CellChangeTimes->{{3.885560636777214*^9, 3.885560641127577*^9}, {
  3.8858189848342752`*^9, 3.8858189867740793`*^9}, {3.88581990945512*^9, 
  3.885819910355236*^9}, {3.885820154102707*^9, 3.8858201553731422`*^9}, {
  3.88582031582272*^9, 3.885820320595546*^9}, {3.885847340208262*^9, 
  3.885847341597299*^9}, {3.885885068460964*^9, 3.88588508004662*^9}, {
  3.8859193831138363`*^9, 3.885919387477397*^9}, {3.885994269931737*^9, 
  3.8859942717283783`*^9}, {3.886158400881708*^9, 
  3.886158402266429*^9}},ExpressionUUID->"6e404117-c5ab-4872-a55d-\
42b432744c3c"],

Cell[BoxData["60"], "Output",
 CellChangeTimes->{
  3.885560642693235*^9, 3.8858184600821238`*^9, 3.885819001385641*^9, {
   3.885819143400238*^9, 3.885819156875066*^9}, 3.88581991645923*^9, 
   3.88582023876437*^9, 3.885820346890432*^9, 3.885847360725397*^9, 
   3.885883784111601*^9, 3.8858839642028*^9, 3.885884739303632*^9, 
   3.8858850918493757`*^9, 3.885893237152828*^9, 3.8859720596332417`*^9, 
   3.8859942753597116`*^9},
 CellLabel->"Out[99]=",ExpressionUUID->"3e5b758b-5f09-4e96-97c4-25d0da52aa57"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"kn", "[", 
   RowBox[{"n1_", ",", "n2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"Pi", "/", "a"}], ")"}], "*", 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{"n1", "^", "2"}], "+", 
     RowBox[{"n2", "^", "2"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mode", "[", 
   RowBox[{"x_", ",", "y_", ",", "n1_", ",", "n2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"2", "/", "a"}], ")"}], "*", 
   RowBox[{"Cos", "[", 
    RowBox[{"n1", "*", "Pi", "*", 
     RowBox[{"x", "/", "a"}]}], "]"}], "*", 
   RowBox[{"Cos", "[", 
    RowBox[{"n2", "*", "Pi", "*", 
     RowBox[{"y", "/", "a"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "[", 
   RowBox[{"x_", ",", "y_", ",", "freq_", ",", "c_"}], "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"mode", "[", 
      RowBox[{
       RowBox[{"a", "/", "2"}], ",", 
       RowBox[{"a", "/", "2"}], ",", "n1", ",", "n2"}], "]"}], "*", 
     RowBox[{
      RowBox[{"mode", "[", 
       RowBox[{"x", ",", "y", ",", "n1", ",", "n2"}], "]"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"kn", "[", 
          RowBox[{"n1", ",", "n2"}], "]"}], "^", "2"}], "-", 
        RowBox[{"(", 
         RowBox[{"freq", "/", "c"}], ")"}]}], ")"}]}]}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"n1", ",", "0", ",", "nTerms"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"n2", ",", "0", ",", "nTerms"}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8855606730936193`*^9, 3.885560675119235*^9}, {
   3.885818482917547*^9, 3.8858185172566347`*^9}, {3.885818797598052*^9, 
   3.885818813535034*^9}, 3.885818965274646*^9, {3.885819575222086*^9, 
   3.8858195768394623`*^9}, {3.8858846920349617`*^9, 3.885884704587618*^9}},
 CellLabel->
  "In[100]:=",ExpressionUUID->"24312c1b-400a-4fbb-9468-a8fc4dae3579"],

Cell[BoxData[
 RowBox[{"ParallelDo", "[", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{
     "\"\</Users/jakebuchanan/code/chladni/ReverseFit/images/Freq\>\"", "<>", 
      
      RowBox[{"ToString", "[", "freq", "]"}], "<>", "\"\<C\>\"", "<>", 
      RowBox[{"StringPadLeft", "[", 
       RowBox[{
        RowBox[{"ToString", "[", "c", "]"}], ",", "6"}], "]"}], "<>", 
      "\"\<.PNG\>\""}], ",", 
     RowBox[{"ContourPlot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"x", ",", "y", ",", "freq", ",", "c"}], "]"}], "==", "0"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", "a"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", "0", ",", "a"}], "}"}], ",", 
       RowBox[{"ContourStyle", "->", 
        RowBox[{"{", 
         RowBox[{"White", ",", 
          RowBox[{"Thickness", "[", "0.01", "]"}]}], "}"}]}], ",", 
       RowBox[{"Background", "->", "Black"}], ",", 
       RowBox[{"PlotTheme", "->", "\"\<Minimal\>\""}]}], "]"}], ",", " ", 
     "\"\<PNG\>\"", ",", 
     RowBox[{"ImageSize", "->", "2355"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", "cLow", ",", "cHigh", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"cHigh", "-", "cLow"}], ")"}], "/", "nRuns"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.885818526549354*^9, 3.885818566265308*^9}, {
   3.8858186809271193`*^9, 3.8858187810116997`*^9}, {3.8858188497676687`*^9, 
   3.885818882083952*^9}, {3.885818931079131*^9, 3.885818943854774*^9}, {
   3.885819130750436*^9, 3.885819152922278*^9}, {3.885819395041683*^9, 
   3.8858193978766413`*^9}, {3.8858195259876957`*^9, 3.885819535557282*^9}, {
   3.885819587529626*^9, 3.885819636847371*^9}, {3.885819810446362*^9, 
   3.885819892309881*^9}, {3.885847061286047*^9, 3.885847255021385*^9}, {
   3.885847295885491*^9, 3.885847325688655*^9}, {3.88584739168232*^9, 
   3.885847392291507*^9}, {3.885847428132947*^9, 3.885847474961486*^9}, {
   3.885847566267685*^9, 3.885847593967288*^9}, {3.8858476487581*^9, 
   3.8858476587496157`*^9}, {3.885847691372657*^9, 3.885847722943563*^9}, {
   3.885847765423195*^9, 3.885847798212092*^9}, {3.885847837277926*^9, 
   3.8858478709253807`*^9}, {3.8858479857852297`*^9, 3.885847997512973*^9}, {
   3.885848114431168*^9, 3.8858481234010344`*^9}, {3.885848184517954*^9, 
   3.885848187697804*^9}, {3.885848227640504*^9, 3.885848288249576*^9}, {
   3.885848431086994*^9, 3.8858484856156*^9}, 3.885848516356082*^9, {
   3.8858486030899687`*^9, 3.885848664218157*^9}, {3.885848694828702*^9, 
   3.885848771384098*^9}, {3.885848841566947*^9, 3.885848877102891*^9}, {
   3.8858489409592867`*^9, 3.885849000209694*^9}, {3.885883908290557*^9, 
   3.885883912381751*^9}, {3.8858842453422413`*^9, 3.8858842509515057`*^9}, {
   3.885884376007428*^9, 3.885884393987273*^9}, {3.885884512438032*^9, 
   3.885884512567499*^9}, {3.885884720854966*^9, 3.885884721038155*^9}, {
   3.8858850303886127`*^9, 3.885885066097192*^9}, {3.885885173720779*^9, 
   3.8858851744972267`*^9}, {3.8859194211365833`*^9, 3.885919423052165*^9}, {
   3.885994145723629*^9, 3.8859942080677023`*^9}, {3.8859946834240847`*^9, 
   3.8859946884653*^9}, {3.8859949681095943`*^9, 3.8859949735590687`*^9}, 
   3.885995185221985*^9},
 CellLabel->
  "In[107]:=",ExpressionUUID->"2cca079a-6d89-400b-b5f4-7d4b81778c45"]
},
WindowSize->{808, 706},
WindowMargins->{{20, Automatic}, {Automatic, 44}},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"13.1 for Mac OS X ARM (64-bit) (June 16, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"546a68e2-b863-4ab3-92a3-c2cc9d71566d"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1204, 29, 157, "Input",ExpressionUUID->"49b35399-ad41-4c64-a40c-eeaff7337e2a"],
Cell[1787, 53, 530, 8, 34, "Output",ExpressionUUID->"d9255cd3-4750-4d74-9dbb-394575e418c2"],
Cell[2320, 63, 532, 8, 34, "Output",ExpressionUUID->"183ca76a-5d91-4d27-99d9-4b12384294aa"],
Cell[2855, 73, 539, 8, 34, "Output",ExpressionUUID->"2f973046-53d3-4a75-a05a-e031bd9524e6"],
Cell[3397, 83, 533, 8, 34, "Output",ExpressionUUID->"fc027934-a8ad-40eb-86e2-b8bed398aaa2"],
Cell[3933, 93, 532, 8, 34, "Output",ExpressionUUID->"56053f14-85f4-4237-9d1a-60b0a251640b"],
Cell[4468, 103, 533, 8, 34, "Output",ExpressionUUID->"ec9a0713-0f14-423c-af29-61cd7c7db50f"],
Cell[5004, 113, 547, 8, 34, "Output",ExpressionUUID->"9a54044c-3410-4d6b-8b3e-db61cbacce5e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5588, 126, 419, 10, 52, "Input",ExpressionUUID->"9b5b74e6-5b5f-44bd-85b5-b3b3527c831c"],
Cell[6010, 138, 525, 8, 34, "Output",ExpressionUUID->"ba1c6796-1b87-4075-b1ed-c73a3cc2f9d6"],
Cell[6538, 148, 526, 8, 34, "Output",ExpressionUUID->"adfcffb6-26bf-4c50-a020-3b5596937841"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7101, 161, 664, 11, 30, "Input",ExpressionUUID->"0fd7c429-659b-4d29-b125-3c79784dd6d2"],
Cell[7768, 174, 534, 8, 34, "Output",ExpressionUUID->"aa338c91-0e96-4001-aaa5-e8cb2502485c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8339, 187, 620, 10, 30, "Input",ExpressionUUID->"6e404117-c5ab-4872-a55d-42b432744c3c"],
Cell[8962, 199, 509, 8, 34, "Output",ExpressionUUID->"3e5b758b-5f09-4e96-97c4-25d0da52aa57"]
}, Open  ]],
Cell[9486, 210, 1893, 52, 115, "Input",ExpressionUUID->"24312c1b-400a-4fbb-9468-a8fc4dae3579"],
Cell[11382, 264, 3352, 65, 136, "Input",ExpressionUUID->"2cca079a-6d89-400b-b5f4-7d4b81778c45"]
}
]
*)


(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     15558,        352]
NotebookOptionsPosition[     13741,        317]
NotebookOutlinePosition[     14188,        334]
CellTagsIndexPosition[     14145,        331]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"freqList", "=", 
  RowBox[{"{", 
   RowBox[{"950", ",", "1223", ",", "1605", ",", "1939"}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"a", "=", "0.24"}], "\[IndentingNewLine]", 
 RowBox[{"cMin", "=", "0.17"}], "\[IndentingNewLine]", 
 RowBox[{"cMax", "=", "0.20"}], "\[IndentingNewLine]", 
 RowBox[{"imgSize", "=", "3024"}], "\[IndentingNewLine]", 
 RowBox[{"nTerms", "=", "40"}], "\[IndentingNewLine]", 
 RowBox[{"nFigures", "=", "60"}], "\[IndentingNewLine]", 
 RowBox[{"d", "=", 
  RowBox[{"0.025", "/", "a"}]}], "\[IndentingNewLine]", 
 RowBox[{"cStep", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"cMax", "-", "cMin"}], ")"}], "/", "nFigures"}]}]}], "Input",
 CellChangeTimes->{{3.889028167700296*^9, 3.889028291757421*^9}, {
  3.889028335497562*^9, 3.889028336759095*^9}, {3.889076369667981*^9, 
  3.8890764701327457`*^9}, {3.889076599285015*^9, 3.889076629859688*^9}, {
  3.889077351941801*^9, 3.889077354957307*^9}, {3.8891035130019093`*^9, 
  3.889103518730649*^9}, {3.889129379282522*^9, 
  3.88912942406224*^9}},ExpressionUUID->"4029109a-d1c8-45e7-a1ed-\
f7e280e2998f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"578", ",", "950", ",", "1223", ",", "1605", ",", "1939"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.889028288356454*^9, 3.889028342766376*^9, 3.88902841142311*^9, 
   3.889076618032878*^9, 3.889077193536541*^9, 3.8890772519332323`*^9, 
   3.8890773648959675`*^9, 3.889077404536852*^9, 3.8890775045048285`*^9, {
   3.889077600612403*^9, 3.8890776208796234`*^9}, 3.8890778035173707`*^9, 
   3.889103331318037*^9, 3.8891033619976673`*^9, 3.889103521795211*^9, 
   3.889104232925809*^9, 3.8891045422681837`*^9, 3.889107393224292*^9, 
   3.889111343703266*^9},
 CellLabel->"Out[1]=",ExpressionUUID->"e5bb3c95-9bee-4b66-acf3-1af114186cdc"],

Cell[BoxData["0.24`"], "Output",
 CellChangeTimes->{
  3.889028288356454*^9, 3.889028342766376*^9, 3.88902841142311*^9, 
   3.889076618032878*^9, 3.889077193536541*^9, 3.8890772519332323`*^9, 
   3.8890773648959675`*^9, 3.889077404536852*^9, 3.8890775045048285`*^9, {
   3.889077600612403*^9, 3.8890776208796234`*^9}, 3.8890778035173707`*^9, 
   3.889103331318037*^9, 3.8891033619976673`*^9, 3.889103521795211*^9, 
   3.889104232925809*^9, 3.8891045422681837`*^9, 3.889107393224292*^9, 
   3.8891113437062683`*^9},
 CellLabel->"Out[2]=",ExpressionUUID->"011b65ea-3717-4351-91f3-2ce0c60a596f"],

Cell[BoxData["0.18`"], "Output",
 CellChangeTimes->{
  3.889028288356454*^9, 3.889028342766376*^9, 3.88902841142311*^9, 
   3.889076618032878*^9, 3.889077193536541*^9, 3.8890772519332323`*^9, 
   3.8890773648959675`*^9, 3.889077404536852*^9, 3.8890775045048285`*^9, {
   3.889077600612403*^9, 3.8890776208796234`*^9}, 3.8890778035173707`*^9, 
   3.889103331318037*^9, 3.8891033619976673`*^9, 3.889103521795211*^9, 
   3.889104232925809*^9, 3.8891045422681837`*^9, 3.889107393224292*^9, 
   3.889111343710269*^9},
 CellLabel->"Out[3]=",ExpressionUUID->"f914ca05-39aa-4231-8a3a-faab5f438f68"],

Cell[BoxData["0.21`"], "Output",
 CellChangeTimes->{
  3.889028288356454*^9, 3.889028342766376*^9, 3.88902841142311*^9, 
   3.889076618032878*^9, 3.889077193536541*^9, 3.8890772519332323`*^9, 
   3.8890773648959675`*^9, 3.889077404536852*^9, 3.8890775045048285`*^9, {
   3.889077600612403*^9, 3.8890776208796234`*^9}, 3.8890778035173707`*^9, 
   3.889103331318037*^9, 3.8891033619976673`*^9, 3.889103521795211*^9, 
   3.889104232925809*^9, 3.8891045422681837`*^9, 3.889107393224292*^9, 
   3.8891113437132688`*^9},
 CellLabel->"Out[4]=",ExpressionUUID->"0b1ec8e0-8634-4241-b52f-14581f98b62b"],

Cell[BoxData["3024"], "Output",
 CellChangeTimes->{
  3.889028288356454*^9, 3.889028342766376*^9, 3.88902841142311*^9, 
   3.889076618032878*^9, 3.889077193536541*^9, 3.8890772519332323`*^9, 
   3.8890773648959675`*^9, 3.889077404536852*^9, 3.8890775045048285`*^9, {
   3.889077600612403*^9, 3.8890776208796234`*^9}, 3.8890778035173707`*^9, 
   3.889103331318037*^9, 3.8891033619976673`*^9, 3.889103521795211*^9, 
   3.889104232925809*^9, 3.8891045422681837`*^9, 3.889107393224292*^9, 
   3.8891113437162685`*^9},
 CellLabel->"Out[5]=",ExpressionUUID->"23882ea5-7b91-4196-b5a5-6c1bf71935af"],

Cell[BoxData["40"], "Output",
 CellChangeTimes->{
  3.889028288356454*^9, 3.889028342766376*^9, 3.88902841142311*^9, 
   3.889076618032878*^9, 3.889077193536541*^9, 3.8890772519332323`*^9, 
   3.8890773648959675`*^9, 3.889077404536852*^9, 3.8890775045048285`*^9, {
   3.889077600612403*^9, 3.8890776208796234`*^9}, 3.8890778035173707`*^9, 
   3.889103331318037*^9, 3.8891033619976673`*^9, 3.889103521795211*^9, 
   3.889104232925809*^9, 3.8891045422681837`*^9, 3.889107393224292*^9, 
   3.8891113437202682`*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"1aa64a47-0c23-492c-96c3-bf7c832692c8"],

Cell[BoxData["60"], "Output",
 CellChangeTimes->{
  3.889028288356454*^9, 3.889028342766376*^9, 3.88902841142311*^9, 
   3.889076618032878*^9, 3.889077193536541*^9, 3.8890772519332323`*^9, 
   3.8890773648959675`*^9, 3.889077404536852*^9, 3.8890775045048285`*^9, {
   3.889077600612403*^9, 3.8890776208796234`*^9}, 3.8890778035173707`*^9, 
   3.889103331318037*^9, 3.8891033619976673`*^9, 3.889103521795211*^9, 
   3.889104232925809*^9, 3.8891045422681837`*^9, 3.889107393224292*^9, 
   3.8891113437232685`*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"83811805-f5b4-443e-ae86-d34090bf2363"],

Cell[BoxData["0.10416666666666669`"], "Output",
 CellChangeTimes->{
  3.889028288356454*^9, 3.889028342766376*^9, 3.88902841142311*^9, 
   3.889076618032878*^9, 3.889077193536541*^9, 3.8890772519332323`*^9, 
   3.8890773648959675`*^9, 3.889077404536852*^9, 3.8890775045048285`*^9, {
   3.889077600612403*^9, 3.8890776208796234`*^9}, 3.8890778035173707`*^9, 
   3.889103331318037*^9, 3.8891033619976673`*^9, 3.889103521795211*^9, 
   3.889104232925809*^9, 3.8891045422681837`*^9, 3.889107393224292*^9, 
   3.8891113437262683`*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"2a0fa9a7-0dfd-4e1c-8de4-45b3046aa007"],

Cell[BoxData["0.0005`"], "Output",
 CellChangeTimes->{
  3.889028288356454*^9, 3.889028342766376*^9, 3.88902841142311*^9, 
   3.889076618032878*^9, 3.889077193536541*^9, 3.8890772519332323`*^9, 
   3.8890773648959675`*^9, 3.889077404536852*^9, 3.8890775045048285`*^9, {
   3.889077600612403*^9, 3.8890776208796234`*^9}, 3.8890778035173707`*^9, 
   3.889103331318037*^9, 3.8891033619976673`*^9, 3.889103521795211*^9, 
   3.889104232925809*^9, 3.8891045422681837`*^9, 3.889107393224292*^9, 
   3.8891113437292686`*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"cac494b7-ea56-4ff3-840b-c145d3173a5f"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"kn", "[", 
   RowBox[{"n1_", ",", "n2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"Pi", "/", "a"}], ")"}], "*", 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{"n1", "^", "2"}], "+", 
     RowBox[{"n2", "^", "2"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mode", "[", 
   RowBox[{"x_", ",", "y_", ",", "n1_", ",", "n2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"2", "/", "a"}], ")"}], "*", 
   RowBox[{"Cos", "[", 
    RowBox[{"n1", "*", "Pi", "*", 
     RowBox[{"x", "/", "a"}]}], "]"}], "*", 
   RowBox[{"Cos", "[", 
    RowBox[{"n2", "*", "Pi", "*", 
     RowBox[{"y", "/", "a"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"An", "[", 
   RowBox[{"freq_", ",", "c_", ",", "n1_", ",", "n2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"mode", "[", 
    RowBox[{
     RowBox[{"a", "/", "2"}], ",", 
     RowBox[{"a", "/", "2"}], ",", "n1", ",", "n2"}], "]"}], "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"freq", "/", "c"}], ")"}], "-", 
       RowBox[{
        RowBox[{"kn", "[", 
         RowBox[{"n1", ",", "n2"}], "]"}], "^", "2"}]}], ")"}], "+", 
     RowBox[{"(", 
      RowBox[{"2", "*", "I", "*", "d", "*", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"freq", "/", "c"}], "]"}]}], ")"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"an", "[", 
   RowBox[{"freq_", ",", "c_", ",", "n1_", ",", "n2_", ",", "norm_"}], "]"}], 
  ":=", 
  RowBox[{
   RowBox[{"An", "[", 
    RowBox[{"freq", ",", "c", ",", "n1", ",", "n2"}], "]"}], "/", 
   "norm"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalPsi]", "[", 
   RowBox[{"x_", ",", "y_", ",", "freq_", ",", "c_", ",", " ", "norm_"}], 
   "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"an", "[", 
      RowBox[{"freq", ",", "c", ",", "n1", ",", "n2", ",", "norm"}], "]"}], 
     "*", 
     RowBox[{"mode", "[", 
      RowBox[{"x", ",", "y", ",", "n1", ",", "n2"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"n1", ",", "0", ",", "nTerms"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"n2", ",", "0", ",", "nTerms"}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8890282989990587`*^9, 3.8890283215983667`*^9}, {
  3.8890283553662233`*^9, 3.8890283583739147`*^9}, {3.8890283888360662`*^9, 
  3.8890284196551733`*^9}, {3.8890765251747217`*^9, 3.889076549287547*^9}, {
  3.8890766408106403`*^9, 3.889076864307048*^9}, {3.889104029329522*^9, 
  3.8891041179231377`*^9}, {3.889107366582699*^9, 3.8891073720603704`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"9c02acec-f6a3-4895-968f-54953d044492"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dir", "=", 
  RowBox[{"NotebookDirectory", "[", "]"}]}]], "Input",
 CellLabel->"In[15]:=",ExpressionUUID->"a6504d1a-5ed7-43c7-8766-ed509ce03947"],

Cell[BoxData["\<\"C:\\\\Users\\\\jakeb\\\\Documents\\\\Code\\\\chladni\\\\\
ReverseFit\\\\\"\>"], "Output",
 CellChangeTimes->{
  3.889028449553548*^9, 3.8890771937923727`*^9, 3.889077252050744*^9, 
   3.889077364995966*^9, 3.889077404627854*^9, 3.8890775046088295`*^9, {
   3.8890776007084055`*^9, 3.8890776210146236`*^9}, 3.889077803591329*^9, 
   3.8891033621443777`*^9, 3.8891041721925907`*^9, 3.889104344306672*^9, 
   3.8891045424780307`*^9, 3.8891073933102922`*^9, 3.8891113438262672`*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"1419d693-1e8d-477d-a1ae-d90803b5d1a0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"ParallelDo", "[", 
    RowBox[{
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{"dir", ",", "\"\<images\>\"", ",", 
          RowBox[{"\"\<Freq\>\"", "<>", 
           RowBox[{"ToString", "[", "freq", "]"}], "<>", "\"\<_C\>\"", "<>", 
           RowBox[{"ToString", "[", "c", "]"}], "<>", "\"\<.PNG\>\""}]}], 
         "}"}], "]"}], ",", 
       RowBox[{
        RowBox[{"norm", "=", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"An", "[", 
               RowBox[{"freq", ",", "c", ",", "n1", ",", "n2"}], "]"}], "]"}],
              "^", "2"}], ",", 
            RowBox[{"{", 
             RowBox[{"n1", ",", "1", ",", "nTerms"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"n2", ",", "1", ",", "nTerms"}], "}"}]}], "]"}], "]"}]}],
         ";", 
        RowBox[{"p", "=", 
         RowBox[{"DensityPlot", "[", 
          RowBox[{
           RowBox[{"1", "/", 
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"\[CapitalPsi]", "[", 
               RowBox[{"x", ",", "y", ",", "freq", ",", "c", ",", "norm"}], 
               "]"}], "]"}], "^", "2"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0", ",", "a"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", "0", ",", "a"}], "}"}], ",", 
           RowBox[{"ColorFunction", "->", "GrayLevel"}], ",", 
           RowBox[{"MaxRecursion", "->", "6"}], ",", 
           RowBox[{"Frame", "->", "None"}], ",", 
           RowBox[{"PlotTheme", "->", "\"\<Minimal\>\""}]}], "]"}]}]}], ",", 
       "\"\<PNG\>\"", ",", 
       RowBox[{"ImageSize", "->", "3024"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", "cMin", ",", "cMax", ",", "cStep"}], "}"}]}], "]"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"freq", ",", "freqList"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.889028432166312*^9, 3.889028434997617*^9}, {
   3.889028478235853*^9, 3.8890285775975103`*^9}, {3.8890287145191593`*^9, 
   3.8890287214420424`*^9}, 3.889028773499864*^9, {3.889076478878243*^9, 
   3.889076511750415*^9}, {3.889076557034771*^9, 3.8890765931417723`*^9}, {
   3.88907663476894*^9, 3.889076635608523*^9}, {3.889076881905912*^9, 
   3.88907690401546*^9}, {3.8890772022188864`*^9, 3.8890772394863033`*^9}, {
   3.889077490647544*^9, 3.889077495632183*^9}, {3.889077589339978*^9, 
   3.889077593375857*^9}, {3.8891021452496166`*^9, 3.8891021568207836`*^9}, {
   3.8891044033390417`*^9, 3.889104416876625*^9}, {3.889107140835763*^9, 
   3.8891071449746885`*^9}, {3.889111323709103*^9, 3.889111331079096*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"aa6f7ff5-d191-49c0-8c0e-02a02a4f801a"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.8891033678015203`*^9, 3.889106873660487*^9, 
  3.889111232033491*^9, 3.8891293419403276`*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"3486b7b8-2c16-400b-ab45-681c28cb0a42"]
}, Open  ]]
},
WindowSize->{718.5, 741.},
WindowMargins->{{Automatic, -5.25}, {Automatic, 0}},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"13.1 for Microsoft Windows (64-bit) (August 22, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"39b46643-a218-4baa-9e92-a70ea4a90f81"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1111, 23, 181, "Input",ExpressionUUID->"4029109a-d1c8-45e7-a1ed-f7e280e2998f"],
Cell[1694, 47, 677, 12, 32, "Output",ExpressionUUID->"e5bb3c95-9bee-4b66-acf3-1af114186cdc"],
Cell[2374, 61, 592, 9, 32, "Output",ExpressionUUID->"011b65ea-3717-4351-91f3-2ce0c60a596f"],
Cell[2969, 72, 590, 9, 32, "Output",ExpressionUUID->"f914ca05-39aa-4231-8a3a-faab5f438f68"],
Cell[3562, 83, 592, 9, 32, "Output",ExpressionUUID->"0b1ec8e0-8634-4241-b52f-14581f98b62b"],
Cell[4157, 94, 591, 9, 32, "Output",ExpressionUUID->"23882ea5-7b91-4196-b5a5-6c1bf71935af"],
Cell[4751, 105, 589, 9, 32, "Output",ExpressionUUID->"1aa64a47-0c23-492c-96c3-bf7c832692c8"],
Cell[5343, 116, 589, 9, 32, "Output",ExpressionUUID->"83811805-f5b4-443e-ae86-d34090bf2363"],
Cell[5935, 127, 607, 9, 32, "Output",ExpressionUUID->"2a0fa9a7-0dfd-4e1c-8de4-45b3046aa007"],
Cell[6545, 138, 594, 9, 32, "Output",ExpressionUUID->"cac494b7-ea56-4ff3-840b-c145d3173a5f"]
}, Open  ]],
Cell[7154, 150, 2672, 74, 143, "Input",ExpressionUUID->"9c02acec-f6a3-4895-968f-54953d044492"],
Cell[CellGroupData[{
Cell[9851, 228, 169, 3, 28, "Input",ExpressionUUID->"a6504d1a-5ed7-43c7-8766-ed509ce03947"],
Cell[10023, 233, 575, 8, 32, "Output",ExpressionUUID->"1419d693-1e8d-477d-a1ae-d90803b5d1a0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10635, 246, 2858, 63, 181, "Input",ExpressionUUID->"aa6f7ff5-d191-49c0-8c0e-02a02a4f801a"],
Cell[13496, 311, 229, 3, 32, "Output",ExpressionUUID->"3486b7b8-2c16-400b-ab45-681c28cb0a42"]
}, Open  ]]
}
]
*)

